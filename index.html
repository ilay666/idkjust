<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coin Clicker</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #f5f5f5;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            height: 100vh;
            color: #333;
        }
        
        .container {
            background-color: white;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            padding: 20px;
            width: 90%;
            max-width: 400px;
            text-align: center;
        }
        
        h1 {
            color: #2c3e50;
            margin-bottom: 10px;
        }
        
        .stats {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            font-size: 16px;
        }
        
        .coin {
            width: 150px;
            height: 150px;
            background-color: #f1c40f;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 20px auto;
            cursor: pointer;
            user-select: none;
            box-shadow: 0 4px 10px rgba(241, 196, 15, 0.4);
            transition: transform 0.1s;
            font-size: 60px;
        }
        
        .coin:active {
            transform: scale(0.95);
        }
        
        .energy-bar {
            width: 100%;
            height: 20px;
            background-color: #ecf0f1;
            border-radius: 10px;
            margin-top: 10px;
            overflow: hidden;
        }
        
        .energy-fill {
            height: 100%;
            background-color: #2ecc71;
            width: 100%;
            transition: width 0.3s;
        }
        
        .click-power {
            margin-top: 15px;
            font-size: 14px;
            color: #7f8c8d;
        }
        
        .debug {
            margin-top: 20px;
            padding: 10px;
            background-color: #f8f9fa;
            border-radius: 5px;
            font-size: 12px;
            color: #666;
            display: none; /* –°–∫—Ä—ã—Ç–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é */
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Coin Clicker</h1>
        <p>–ö–ª–∏–∫–∞–π –ø–æ –º–æ–Ω–µ—Ç–µ, —á—Ç–æ–±—ã –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å!</p>
        
        <div class="stats">
            <div>
                <div>üí∞ –ë–∞–ª–∞–Ω—Å</div>
                <div id="balance">0.00</div>
            </div>
            <div>
                <div>‚ö° –≠–Ω–µ—Ä–≥–∏—è</div>
                <div id="energy">300/300</div>
                <div class="energy-bar">
                    <div class="energy-fill" id="energy-fill"></div>
                </div>
            </div>
        </div>
        
        <div class="coin" id="coin">ü™ô</div>
        
        <div class="click-power">
            –°–∏–ª–∞ –∫–ª–∏–∫–∞: <span id="click-power">0.01</span> coins
        </div>
        
        <div class="debug" id="debug">
            <p>Debug info:</p>
            <p id="debug-info"></p>
            <button id="test-btn">–¢–µ—Å—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏</button>
        </div>
    </div>

    <script>
        // –≠–ª–µ–º–µ–Ω—Ç—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        const coin = document.getElementById('coin');
        const balanceDisplay = document.getElementById('balance');
        const energyDisplay = document.getElementById('energy');
        const energyFill = document.getElementById('energy-fill');
        const clickPowerDisplay = document.getElementById('click-power');
        const debugInfo = document.getElementById('debug-info');
        const debugPanel = document.getElementById('debug');
        
        // –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–±—É–¥—É—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å—Å—è)
        let userData = {
            coins: 0,
            energy: 300,
            maxEnergy: 300,
            clickPower: 0.01
        };
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è WebApp Telegram
        function initTelegramWebApp() {
            Telegram.WebApp.ready();
            Telegram.WebApp.expand();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º debug –ø–∞–Ω–µ–ª—å, –µ—Å–ª–∏ —ç—Ç–æ —Ç–µ—Å—Ç
            if (Telegram.WebApp.initDataUnsafe.user) {
                debugPanel.style.display = 'block';
                debugInfo.textContent = JSON.stringify(Telegram.WebApp.initData, null, 2);
            }
            
            // –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ —É –±–æ—Ç–∞
            requestUserData();
        }
        
        // –ó–∞–ø—Ä–æ—Å –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —É –±–æ—Ç–∞
        function requestUserData() {
            if (Telegram.WebApp.initDataUnsafe.user) {
                const user = Telegram.WebApp.initDataUnsafe.user;
                
                // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –Ω–∞ –¥–∞–Ω–Ω—ã–µ (–±–æ—Ç –±—É–¥–µ—Ç –æ—Ç–≤–µ—á–∞—Ç—å —á–µ—Ä–µ–∑ —Å–æ–æ–±—â–µ–Ω–∏–µ)
                Telegram.WebApp.sendData(JSON.stringify({
                    action: "get_user_data",
                    user_id: user.id
                }));
            } else {
                updateUI();
            }
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        function updateUI() {
            balanceDisplay.textContent = userData.coins.toFixed(2);
            energyDisplay.textContent = `${userData.energy}/${userData.maxEnergy}`;
            energyFill.style.width = `${(userData.energy / userData.maxEnergy) * 100}%`;
            clickPowerDisplay.textContent = userData.clickPower.toFixed(2);
        }
        
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–∞ –ø–æ –º–æ–Ω–µ—Ç–µ
        coin.addEventListener('click', function() {
            if (userData.energy <= 0) {
                alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —ç–Ω–µ—Ä–≥–∏–∏! –ü–æ–¥–æ–∂–¥–∏—Ç–µ –Ω–µ–º–Ω–æ–≥–æ.");
                return;
            }
            
            // –ê–Ω–∏–º–∞—Ü–∏—è –∫–ª–∏–∫–∞
            this.style.transform = 'scale(0.95)';
            setTimeout(() => {
                this.style.transform = 'scale(1)';
            }, 100);
            
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –±–æ—Ç—É
            if (Telegram.WebApp.initDataUnsafe.user) {
                Telegram.WebApp.sendData(JSON.stringify({
                    action: "click",
                    user_id: Telegram.WebApp.initDataUnsafe.user.id,
                    timestamp: Date.now()
                }));
            }
            
            // –õ–æ–∫–∞–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ (–±—É–¥–µ—Ç –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞–Ω–æ –ø—Ä–∏ –æ—Ç–≤–µ—Ç–µ –±–æ—Ç–∞)
            userData.coins += userData.clickPower;
            userData.energy--;
            updateUI();
        });
        
        // –¢–µ—Å—Ç–æ–≤–∞—è –∫–Ω–æ–ø–∫–∞
        document.getElementById('test-btn').addEventListener('click', function() {
            Telegram.WebApp.sendData(JSON.stringify({
                action: "test",
                message: "–¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ WebApp"
            }));
            alert("–¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã!");
        });
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.addEventListener('DOMContentLoaded', initTelegramWebApp);
    </script>
</body>
</html>
